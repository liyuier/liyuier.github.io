---
title: ‰ΩøÁî® nginx - docker ÈÉ®ÁΩ≤ÂçöÂÆ¢
titleTemplate: '%s - yuier'
date: 2025-03-25 23:45:36
updated: 2025-03-25 23:45:36
author: yuier
cover: 
hide: 
---

‰∏ç‰ΩøÁî® docker ÈÉ®ÁΩ≤Ê≠•È™§ËßÅ [‰∏™‰∫∫ÂçöÂÆ¢ÁöÑÊê≠Âª∫‰∏éÈÉ®ÁΩ≤](https://yuier.com/posts/002-blog-deploy) Ôºà‰∏çÊé®ËçêÔºâ

<!-- more -->

## ÊûÅÁÆÄÁâà

ÂÅáËÆæËØªËÄÖÂ∑≤ÁªèÂÆåÊàê‰∫ÜË¥≠‰π∞ÊúçÂä°Âô®ÔºõÂÆâË£Ö Linux(Ubuntu) Á≥ªÁªüÔºõË¥≠‰π∞ÂüüÂêçÔºõÂüüÂêçÂ§áÊ°àÔºàÂ¶ÇÊúâÈúÄË¶ÅÔºâÔºõÁî≥ËØ∑Âπ∂‰∏ãËΩΩ ssl ËØÅ‰π¶ÔºõÂú®ÊúçÂä°Âô®‰∏äÈÖçÁΩÆ git „ÄÅnode„ÄÅpnpm ÁéØÂ¢ÉÔºõÂÆâË£Ö docker Âπ∂ÊãâÂèñ `nginx:latest` ÈïúÂÉèÔºõÂèÇËÄÉ [Valaxy - Getting Started](https://valaxy.site/guide/getting-started) Âú®Êú¨Âú∞Êê≠Âª∫Ëµ∑ÂçöÂÆ¢ÊúçÂä°Á≠â‰∏ÄÁ≥ªÂàóÂâçÁΩÆÂ∑•‰Ωú„ÄÇ

### ÈúÄË¶Å‰ΩøÁî®ÁöÑÂ∑•‰ΩúÁõÆÂΩïÂíåÊñá‰ª∂

> ÂÖçË¥£Â£∞ÊòéÔºö‰ª•‰∏ãÊâÄÊúâÁõÆÂΩïÂÖ∑‰ΩìË∑ØÂæÑÈÄâÊã©ÁêÜÁî±Âùá‰∏∫‰ø∫ÂØªÊÄùËøô‰πàÊï¥ËÉΩË°åÔºåÂπ∂‰∏ç‰ª£Ë°®Á¨îËÄÖËÆ§ÂÆö‰ª•‰∏ã‰∏∫ÊúÄ‰Ω≥ÂÆûË∑µ

#### git Â∑•‰ΩúÊµÅ

ÊàëÁöÑÊåÅÁª≠ÈÉ®ÁΩ≤ÊÄùË∑ØÊòØËøôÊ†∑ÁöÑÔºöÊú¨Âú∞‰øÆÊîπÂ•Ω blog ‚Äî‚Äî ÈÄöËøá git Êé®ÈÄÅÂà∞ÊúçÂä°Âô®‰∏äÁöÑËøúÁ®ã‰ªì ‚Äî‚Äî Âú®ËøúÁ®ã‰ªì‰∏ä‰ΩøÁî® git hooks ÂÆåÊàê‰ªìÂ∫ì pull Âà∞ÔºàÊúçÂä°Âô®‰∏äÁöÑÔºâÊú¨Âú∞Âπ∂ÊûÑÂª∫ ‚Äî‚Äî ÊúÄÁªàÂ∞ÜÊûÑÂª∫‰∫ßÁâ©Â§çÂà∂Âà∞ nginx Â∑•‰ΩúÁõÆÂΩïÔºàÁöÑÊåÇËΩΩÁõÆÂΩï‰∏ãÔºâ

~~Ê≠£Â¶Ç‰∏äÈù¢ÊâÄËØ¥ÔºåÊàëÈÄâÊã©ËøôÂ•óÂ∑•‰ΩúÊµÅÁöÑÁêÜÁî±‰πüÊòØ‰ø∫ÂØªÊÄùËøô‰πàÊï¥ËÉΩË°å~~

- git ËøúÁ®ã‰ªìÂ∫ìÔºåÁî®‰∫éÊú¨Âú∞‰øÆÊîπ blog ÂêéÂ∞Ü‰ª£Á†ÅÊé®ÈÄÅÂà∞ÊúçÂä°Âô®

    ÂèÇËÄÉ [Êê≠Âª∫Ëá™Â∑±ÁöÑ git ËøúÁ®ã‰ªìÂ∫ìÊúçÂä°](https://yuier.com/posts/001-build-self-gitrepo-server) ÔºåÊúÄÁªàÂú® `/home/git/repos/liyuier.github.io.git` ‰∏ãÊê≠Âª∫Ëµ∑ÂçöÂÆ¢ÁöÑËøúÁ®ã‰ªìÂ∫ì

    Âú®Êú¨Âú∞ÂçöÂÆ¢‰ªìÂ∫ìÔºå‰ΩøÁî® `git remote add` ÂëΩ‰ª§Â∞ÜËØ•‰ªìÂ∫ìÊ∑ªÂä†‰∏∫Êú¨Âú∞‰ªìÁöÑËøúÁ®ã‰ªìÂ∫ì„ÄÇÊàëËøôÈáåÂ∞ÜÂÖ∂ÂëΩÂêç‰∏∫ `yuier`

    ```bash
    $ git remote -v
    origin  git@github.com:liyuier/liyuier.github.io.git (fetch)
    origin  git@github.com:liyuier/liyuier.github.io.git (push)
    yuier   git@yuier.com:/home/git/repos/liyuier.github.io.git (fetch)  # ËøôÈáåÂ∞±ÊòØËøúÁ®ã‰ªì
    yuier   git@yuier.com:/home/git/repos/liyuier.github.io.git (push)
    ```

- ÊúçÂä°Âô®ÊûÑÂª∫Â∑•‰ΩúÁõÆÂΩï

    Êú¨Âú∞‰ª£Á†ÅÊé®ÈÄÅÂà∞ËøúÁ®ã‰ªìÂêéÔºåÈÄöËøá `git hooks` ËÑöÊú¨Â∞Ü‰ª£Á†Å pull Âà∞ÊúçÂä°Âô®‰∏äÂè¶‰∏Ä‰∏™ÁõÆÂΩï‰∏ãÂπ∂ÊâßË°åÊûÑÂª∫Â∑•‰Ωú

    ËøôÈáåÊàëÈÄâÊã©ÊîæÂú® `/usr/dev/blog/liyuier.github.io`

- ÊûÑÂª∫ÁªìÊûúÂ≠òÊîæÁõÆÂΩï

    ÊûÑÂª∫ÂÆåÊØïÂêéÔºåÂÜçÊ¨°Â∞Ü `dist` ÁõÆÂΩï‰∏ãÁöÑÊûÑÂª∫‰∫ßÁâ©Â§çÂà∂Âà∞Á¨¨‰∏â‰∏™ÁõÆÂΩï‰∏ãÔºåÁ¨¨‰∏â‰∏™ÁõÆÂΩï‰ºöÂú® nginx ÂÆπÂô®ÂêØÂä®Êó∂ÊåÇËΩΩ‰∏∫ÂÆπÂô®ÂÜÖ nginx ÁöÑÂ∑•‰ΩúÁõÆÂΩïÔºå‰∫éÊòØ nginx ÂÆπÂô®‰æøÂèØ‰ª•‰ª•Êàë‰ª¨ÁöÑÊûÑÂª∫‰∫ßÁâ©ÂêØÂä®ÊúçÂä°

    Ëøô‰∏™ÁõÆÂΩïÊàëÈÄâÊã© `/srv/blog/nginx/html`

- git hooks

    Âú® `/home/git/repos/liyuier.github.io.git/hooks` ÁõÆÂΩï‰∏ãÔºåÊñ∞Âª∫‰∏Ä‰∏™Âêç‰∏∫ `post-receive` ÁöÑÊñá‰ª∂„ÄÇËØ•Êñá‰ª∂‰ºöÂú®Êé•Êî∂Âà∞ git Êé®ÈÄÅÂêéËá™Âä®ÊâßË°å„ÄÇ

    ```bash
    # ÂÆö‰πâÊó•ÂøóÊñá‰ª∂Ë∑ØÂæÑÔºàÊé®ËçêÂ≠òÊîæÂú® git Áî®Êà∑ÊúâÊùÉÈôêÁöÑÁõÆÂΩïÔºâ
    LOG_FILE="/home/git/logs/blog_deploy.log"
    DEPLOY_LOG_DIR=$(dirname "$LOG_FILE")

    # ÂàõÂª∫Êó•ÂøóÁõÆÂΩïÔºàÂ¶ÇÊûú‰∏çÂ≠òÂú®Ôºâ
    mkdir -p "$DEPLOY_LOG_DIR"
    sudo chown git:git "$DEPLOY_LOG_DIR"  # Á°Æ‰øùÁõÆÂΩïÊâÄÊúâÊùÉ

    # ÈáçÂÆöÂêëÊâÄÊúâËæìÂá∫Âà∞Êó•ÂøóÊñá‰ª∂ÔºàËøΩÂä†Ê®°ÂºèÔºâ
    exec >> "$LOG_FILE" 2>&1

    # Ê∑ªÂä†Êó∂Èó¥Êà≥ÂàÜÈöîÁ¨¶
    echo -e "\n\n=== $(date '+%Y-%m-%d %H:%M:%S') ÂºÄÂßãÈÉ®ÁΩ≤ ==="

    #!/bin/bash  # ÊåáÂÆö‰ΩøÁî® bash shell Ëß£ÈáäÂô®

    # ÂÆö‰πâÂèòÈáèÔºöÂ∑•‰ΩúÁõÆÂΩïË∑ØÂæÑÔºàÂøÖÈ°ª‰∏é‰πãÂâçÂàõÂª∫ÁöÑÁõÆÂΩï‰∏ÄËá¥Ôºâ
    TARGET="/usr/dev/blog/liyuier.github.io"

    # ÂÆö‰πâÂèòÈáèÔºöNginx ÁöÑÁΩëÁ´ôÊ†πÁõÆÂΩïÔºàÊúÄÁªàÈÉ®ÁΩ≤‰ΩçÁΩÆÔºâ
    DEPLOY_DIR="/srv/blog/nginx/html"

    # ÂÆö‰πâÂèòÈáèÔºöGit Ë£∏‰ªìÂ∫ìË∑ØÂæÑÔºàÁî®‰∫é git ÂëΩ‰ª§Êìç‰ΩúÔºâ
    GIT_DIR="/home/git/repos/liyuier.github.io.git"

    echo "‚ûú Starting auto deployment..."  # ËæìÂá∫ÂºÄÂßãÊèêÁ§∫‰ø°ÊÅØ

    # Âº∫Âà∂Ê£ÄÂá∫‰ª£Á†ÅÂà∞Â∑•‰ΩúÁõÆÂΩïÔºà--work-tree ÊåáÂÆöÂ∑•‰ΩúÂå∫Ôºå--git-dir ÊåáÂÆö‰ªìÂ∫ì‰ΩçÁΩÆÔºâ
    git --work-tree=$TARGET --git-dir=$GIT_DIR checkout -f

    # ÂàáÊç¢Âà∞Â∑•‰ΩúÁõÆÂΩïÔºàÂáÜÂ§áÊâßË°åÊûÑÂª∫ÂëΩ‰ª§Ôºâ
    cd $TARGET

    # ÂÆâË£Ö‰æùËµñÔºà--frozen-lockfile Ë°®Á§∫‰∏•Ê†º‰ΩøÁî® lock Êñá‰ª∂ÁâàÊú¨ÔºåÈÅøÂÖçÁâàÊú¨ÂÜ≤Á™ÅÔºâ
    pnpm install --frozen-lockfile

    # ÊâßË°åÊûÑÂª∫ÂëΩ‰ª§ÔºàÊ†πÊçÆÈ°πÁõÆÈÖçÁΩÆÔºåÁîüÊàê dist/ ÁõÆÂΩïÔºâ
    pnpm run build

    # Ê∏ÖÁêÜÊóßÁöÑÈÉ®ÁΩ≤Êñá‰ª∂ÔºàÈÅøÂÖçÊÆãÁïôÊñá‰ª∂Âπ≤Êâ∞Ôºâ
    sudo rm -rf $DEPLOY_DIR/*

    # ÈÄíÂΩíÂ§çÂà∂ÊûÑÂª∫ÁªìÊûúÂà∞ Nginx ÁõÆÂΩïÔºà-a ÂèÇÊï∞‰øùÁïôÊñá‰ª∂Â±ûÊÄßÔºâ
    sudo cp -a dist/* $DEPLOY_DIR/

    # ‰øÆÊîπÈÉ®ÁΩ≤ÁõÆÂΩïÊâÄÊúâÊùÉÔºàÂÅáËÆæ Nginx ‰ª• www-data Áî®Êà∑ËøêË°åÔºâ
    # ÊÑüËßâÁî® docker ÈÉ®ÁΩ≤ÁöÑËØùÔºåËøô‰∏ÄÊ≠•Ê≤°ÂøÖË¶Å
    # sudo chown -R root $DEPLOY_DIR

    echo "‚úÖ Deployment completed! Nginx content updated."  # ËæìÂá∫ÂÆåÊàêÊèêÁ§∫

    # Ê£ÄÊü•ÈÖçÁΩÆËØ≠Ê≥ï
    # ÂÆö‰πâÂèòÈáè
    CONTAINER_NAME="blog"  # ÊõøÊç¢‰∏∫‰Ω†ÁöÑÂÆπÂô®ÂêçÁß∞ÊàñID

    # Ê£ÄÊü• Nginx ÈÖçÁΩÆÊñá‰ª∂ËØ≠Ê≥ï
    sudo docker exec $CONTAINER_NAME nginx -t > /dev/null 2>&1

    # Âà§Êñ≠ÂëΩ‰ª§ÊâßË°åÁªìÊûú
    if [ $? -eq 0 ]; then
        echo "Nginx ÈÖçÁΩÆÊñá‰ª∂ËØ≠Ê≥ïÊ≠£Á°Æ"
    else
        echo "Nginx ÈÖçÁΩÆÊñá‰ª∂ËØ≠Ê≥ïÈîôËØØÔºåËØ∑Ê£ÄÊü•ÔºÅ"
        exit 1
    fi

    # ÊâßË°åÈáçËΩΩ
    sudo docker exec $CONTAINER_NAME nginx -s reload
    echo "üîÑ Nginx Â∑≤Âπ≥ÊªëÈáçËΩΩ"
    ```

    ËÑöÊú¨‰∏≠ÊúâÂæàÂ§ö `sudo` ÂëΩ‰ª§Ôºå‰∏∫‰∫Ü‰ΩøËÑöÊú¨ÊâßË°åÊó∂‰∏çÈúÄË¶ÅËæìÂÖ•ÂØÜÁ†ÅÔºåÈúÄË¶Å‰øÆÊîπ `sudoers` Êñá‰ª∂„ÄÇÂÖ∑‰ΩìÊñπÊ≥ïÂèØ‰ª•ÂèÇËÄÉ [ËÆ©LinuxÁî®Êà∑sudoÊìç‰ΩúÂÖçÂØÜÁ†Å](https://bingozb.github.io/views/default/58.html) .
    
#### nginx ÂÆπÂô®

ËøôÈÉ®ÂàÜÔºåÊàë‰ª¨ÈúÄË¶ÅÂáÜÂ§á nginx ÂÆπÂô®ÂêØÂä®ËÑöÊú¨„ÄÅnginx ÈÖçÁΩÆÊñá‰ª∂„ÄÅnginx ÂÆπÂô®ÊåÇËΩΩÁõÆÂΩïÁ≠â„ÄÇ

Ëøô‰∫õÂ∞±‰∏çËß£Èáä‰∫ÜÔºåÈÄöÁî®ÂÅöÊ≥ï„ÄÇ

- nginx ÊåÇËΩΩÁõÆÂΩï

    ‰∏äÊñá‰∏≠Êàë‰ª¨ÂáÜÂ§áÁöÑÊûÑÂª∫ÁªìÊûúÂ≠òÊîæÁõÆÂΩïÂÖ∂ÂÆûÂ∞±ÊòØÊï¥‰∏™ÊåÇËΩΩÁõÆÂΩï ‚ÄúÂ•óË£Ö‚Äù ÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇÂÆåÊï¥ÁöÑÁéØÂ¢ÉÊòØËøôÊ†∑ÁöÑÔºö

    ```bash
    $ pwd
    /srv/blog/nginx
    $ tree -L 1
    .
    ‚îú‚îÄ‚îÄ conf.d
    ‚îÇ   ‚îî‚îÄ‚îÄ blog.conf  # ÂçöÂÆ¢ÊúçÂä°ÈÖçÁΩÆ
    ‚îú‚îÄ‚îÄ html
    ‚îÇ   ‚îú‚îÄ‚îÄ index.html  # ÊûÑÂª∫‰∫ßÁâ©
    ‚îÇ   ‚îú‚îÄ‚îÄ ...
    ‚îú‚îÄ‚îÄ logs
    ‚îÇ   ‚îú‚îÄ‚îÄ access.log  # ËÆøÈóÆÊó•Âøó
    ‚îÇ   ‚îú‚îÄ‚îÄ error.log  # ÂêÑÁ≠âÁ∫ßÊó•Âøó
    ‚îÇ   ‚îú‚îÄ‚îÄ info.log
    ‚îÇ   ‚îî‚îÄ‚îÄ notice.log
    ‚îú‚îÄ‚îÄ mime.types  # ÊåáÂÆö‰∏çÂêåÁ±ªÂûãËµÑÊ∫êÂ§ÑÁêÜÊñπÂºèÁöÑÊñá‰ª∂ÔºåÂÖ∑‰ΩìÂèØ‰ª•ÈóÆÂ§ßÊ®°Âûã
    ‚îú‚îÄ‚îÄ nginx.conf  # ‰∏ªÈÖçÁΩÆ
    ‚îú‚îÄ‚îÄ ssl
    ‚îÇ   ‚îú‚îÄ‚îÄ yuier.com_bundle.crt  # ssl ËØÅ‰π¶Êñá‰ª∂
    ‚îÇ   ‚îî‚îÄ‚îÄ yuier.com.key
    ‚îî‚îÄ‚îÄ start.sh  # nginx docker ÂêØÂä®ËÑöÊú¨
    ```

- ÂêÑÊñá‰ª∂ÂÜÖÂÆπ

    - blog.conf

        ``` conf
        # Âº∫Âà∂ HTTP Ë∑≥ËΩ¨ HTTPSÔºàÈáçË¶ÅÔºÅÔºâ
        server {
            listen 80;
            server_name yuier.com;

            # 301 Ê∞∏‰πÖÈáçÂÆöÂêë
            return 301 https://$host$request_uri;
        }

        #HTTPSÊúçÂä°Âô®
        server {

            listen 443 ssl;  # ÂêØÁî® HTTP/2
            server_name yuier.com;
            
            # SSL ËØÅ‰π¶ÈÖçÁΩÆÔºàËØ∑‰øÆÊîπ‰∏∫‰Ω†ÁöÑÂÆûÈôÖË∑ØÂæÑÔºâ
            ssl_certificate /etc/nginx/ssl/yuier.com_bundle.crt;  # ËØÅ‰π¶ÈìæÊñá‰ª∂
            ssl_certificate_key /etc/nginx/ssl/yuier.com.key;  # ÁßÅÈí•Êñá‰ª∂

            # ÂêØÁî® OCSP Stapling ÊèêÂçáÊÄßËÉΩ
            ssl_stapling on;
            ssl_stapling_verify on;
            resolver 8.8.8.8 1.1.1.1 valid=300s;
            resolver_timeout 5s;

            # ÂÆâÂÖ®ÂìçÂ∫îÂ§¥
            add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload";
            add_header X-Content-Type-Options nosniff;
            add_header X-Frame-Options DENY;

            gzip on;
            gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;

            index index.html;

            location / {
                # content location
                # root /app;
                root /usr/share/nginx/html;

                # exact matches -> reverse clean urls -> folders -> not found
                try_files $uri $uri.html $uri/ =404;

                # non existent pages
                error_page 404 /404.html;

                # a folder without index.html raises 403 in this setup
                error_page 403 /404.html;

                # adjust caching headers
                # files in the assets folder have hashes filenames
                location ~* ^/assets/ {
                    expires 1y;
                    add_header Cache-Control "public, immutable";
                }
            }
        }
        ```

    - mime.types

        ```types
        types {
                text/html                             html htm shtml;
                text/css                              css;
                text/xml                              xml;
                image/gif                             gif;
                image/jpeg                            jpeg jpg;
                application/javascript                js;
                application/atom+xml                  atom;
                application/rss+xml                   rss;

                text/mathml                           mml;
                text/plain                            txt;
                text/vnd.sun.j2me.app-descriptor      jad;
                text/vnd.wap.wml                      wml;
                text/x-component                      htc;

                image/png                             png;
                image/tiff                            tif tiff;
                image/vnd.wap.wbmp                    wbmp;
                image/x-icon                          ico;
                image/x-jng                           jng;
                image/x-ms-bmp                        bmp;
                image/svg+xml                         svg svgz;
                image/webp                            webp;

                application/font-woff                 woff;
                application/java-archive              jar war ear;
                application/json                      json;
                application/mac-binhex40              hqx;
                application/msword                    doc;
                application/pdf                       pdf;
                application/postscript                ps eps ai;
                application/rtf                       rtf;
                application/vnd.apple.mpegurl         m3u8;
                application/vnd.ms-excel              xls;
                application/vnd.ms-fontobject         eot;
                application/vnd.ms-powerpoint         ppt;
                application/vnd.wap.wmlc              wmlc;
                application/vnd.google-earth.kml+xml  kml;
                application/vnd.google-earth.kmz      kmz;
                application/x-7z-compressed           7z;
                application/x-cocoa                   cco;
                application/x-java-archive-diff       jardiff;
                application/x-java-jnlp-file          jnlp;
                application/x-makeself                run;
                application/x-perl                    pl pm;
                application/x-pilot                   prc pdb;
                application/x-rar-compressed          rar;
                application/x-redhat-package-manager  rpm;
                application/x-sea                     sea;
                application/x-shockwave-flash         swf;
                application/x-stuffit                 sit;
                application/x-tcl                     tcl tk;
                application/x-x509-ca-cert            der pem crt;
                application/x-xpinstall               xpi;
                application/xhtml+xml                 xhtml;
                application/xspf+xml                  xspf;
                application/zip                       zip;

                application/octet-stream              bin exe dll;
                application/octet-stream              deb;
                application/octet-stream              dmg;
                application/octet-stream              iso img;
                application/octet-stream              msi msp msm;

                application/vnd.openxmlformats-officedocument.wordprocessingml.document    docx;
                application/vnd.openxmlformats-officedocument.spreadsheetml.sheet          xlsx;
                application/vnd.openxmlformats-officedocument.presentationml.presentation  pptx;

                audio/midi                            mid midi kar;
                audio/mpeg                            mp3;
                audio/ogg                             ogg;
                audio/x-m4a                           m4a;
                audio/x-realaudio                     ra;

                video/3gpp                            3gpp 3gp;
                video/mp2t                            ts;
                video/mp4                             mp4;
                video/mpeg                            mpeg mpg;
                video/quicktime                       mov;
                video/webm                            webm;
                video/x-flv                           flv;
                video/x-m4v                           m4v;
                video/x-mng                           mng;
                video/x-ms-asf                        asx asf;
                video/x-ms-wmv                        wmv;
                video/x-msvideo                       avi;
            }
        ```

    - nginx.conf

        ÂÖ∂ÂÆûËøô‰∏™Êñá‰ª∂ÊòØÂÖàÁÆÄÂçï docker run Ëµ∑‰∏Ä‰∏™ÂÆπÂô®ÔºåÁÑ∂ÂêéÁî® 

        > docker cp <ÂÆπÂô®IDÊàñÂêçÁß∞>:<ÂÆπÂô®ÂÜÖÁöÑË∑ØÂæÑ> <‰∏ªÊú∫‰∏äÁöÑÁõÆÊ†áË∑ØÂæÑ>

        ÂëΩ‰ª§Â§çÂà∂Âá∫Êù•ÁöÑ„ÄÇ

        ``` conf
        user  nginx;
        worker_processes  auto;

        error_log  /var/log/nginx/error.log notice;
        pid        /var/run/nginx.pid;


        events {
            worker_connections  1024;
        }


        http {
            include       /etc/nginx/mime.types;
            default_type  application/octet-stream;

            log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
                            '$status $body_bytes_sent "$http_referer" '
                            '"$http_user_agent" "$http_x_forwarded_for"';

            access_log  /var/log/nginx/access.log  main;

            sendfile        on;
            #tcp_nopush     on;

            keepalive_timeout  65;

            #gzip  on;

            # Â∞Ü conf.d ÁõÆÂΩï‰∏ãÊâÄÊúâÊñá‰ª∂ÈÉΩ include ËøõÊù•„ÄÇÂç≥‰∏äÊñá‰∏≠ÁöÑ blog.conf Êñá‰ª∂Â∞±‰ºöË¢´ include
            include /etc/nginx/conf.d/*.conf;
        }
        ```

    - start.sh

        ```bash
        #!/bin/bash

        # ËØ•ËÑöÊú¨‰ºö‰ª• nginx:latest ÈïúÂÉèÂêØÂä®‰∏Ä‰∏™Âêç‰∏∫ blog ÁöÑÂÆπÂô®
        # Â¶ÇÊûú‰∏ãËø∞ÂëΩ‰ª§ÊâßË°åÊó∂Â≠òÂú®ÊùÉÈôêÈóÆÈ¢òÔºåÂ∞±ÈÉΩÊîπÊàê sudo Â•Ω‰∫Ü

        # --------------------------------------------
        # ÂÆö‰πâÊú¨Âú∞Ë∑ØÂæÑÂèòÈáèÔºàÊåâÂÆûÈôÖË∑ØÂæÑ‰øÆÊîπÔºÅÔºâ
        # --------------------------------------------
        LOCAL_NGINX_DIR="/srv/blog/nginx"  # ÊõøÊç¢‰∏∫‰Ω†ÁöÑÂÆûÈôÖË∑ØÂæÑ
        LOCAL_CONF_DIR="${LOCAL_NGINX_DIR}/conf.d"
        LOCAL_LOGS_DIR="${LOCAL_NGINX_DIR}/logs"
        LOCAL_SSL_DIR="${LOCAL_NGINX_DIR}/ssl"
        LOCAL_HTML_DIR="${LOCAL_NGINX_DIR}/html"

        # --------------------------------------------
        # Ê£ÄÊü•Êú¨Âú∞ÁõÆÂΩïÊòØÂê¶Â≠òÂú®Ôºå‰∏çÂ≠òÂú®ÂàôÂàõÂª∫
        # --------------------------------------------
        mkdir -p "$LOCAL_CONF_DIR" "$LOCAL_LOGS_DIR" "$LOCAL_SSL_DIR"

        # --------------------------------------------
        # ÂÅúÊ≠¢Âπ∂Âà†Èô§ÊóßÂÆπÂô®ÔºàÈò≤Ê≠¢ÂÜ≤Á™ÅÔºâ
        # --------------------------------------------
        docker stop blog >/dev/null 2>&1
        docker rm blog >/dev/null 2>&1

        # --------------------------------------------
        # ÂêØÂä®NginxÂÆπÂô®ÔºàÂÖ≥ÈîÆ‰øÆÊ≠£ÁÇπÔºâ
        # -p ÈÄâÈ°πÁî®‰∫éÊò†Â∞ÑÁ´ØÂè£ÔºõÂÜíÂè∑Ââç‰∏∫‰∏ªÊú∫Á´ØÂè£ÔºåÂÜíÂè∑Âêé‰∏∫ÂÆπÂô®Á´ØÂè£
        # -v ÈÄâÈ°πÁî®‰∫éÊåÇËΩΩË∑ØÂæÑÔºõÂÜíÂè∑Ââç‰∏∫‰∏ªÊú∫Ë∑ØÂæÑÔºåÂÜíÂè∑Âêé‰∏∫ÂÆπÂô®Ë∑ØÂæÑ
        # --------------------------------------------
        docker run -d \
        --name blog \
        -p 80:80 \
        -p 443:443 \
        -v "${LOCAL_CONF_DIR}:/etc/nginx/conf.d" \
        -v "${LOCAL_NGINX_DIR}/nginx.conf:/etc/nginx/nginx.conf" \
        -v "${LOCAL_NGINX_DIR}/mime.types:/etc/nginx/mime.types" \
        -v "${LOCAL_SSL_DIR}:/etc/nginx/ssl" \
        -v "${LOCAL_LOGS_DIR}:/var/log/nginx" \
        -v "${LOCAL_HTML_DIR}:/usr/share/nginx/html" \
        nginx:latest  # Á°Æ‰øùÈïúÂÉèÂêçÁß∞Ê≠£Á°ÆÔºÅ

        # --------------------------------------------
        # Ê£ÄÊü•ÂÆπÂô®Áä∂ÊÄÅ
        # --------------------------------------------
        echo "Ê£ÄÊü•ÂÆπÂô®Áä∂ÊÄÅÔºö"
        docker ps -f name=blog

        # Êü•ÁúãÊó•ÂøóÔºàË∞ÉËØïÁî®Ôºâ
        echo -e "\nÊü•ÁúãÂÆπÂô®Êó•ÂøóÔºö"
        docker logs blog --tail 50
        ```

### BlogÔºåÂêØÂä®ÔºÅ

‰∏á‰∫ã‰ø±Â§á„ÄÇÈ¶ñÂÖàÊâßË°å `./start.sh` ÂêØÂä®ÂÆπÂô®ÔºåËÆøÈóÆ `your-site.domain` Á°ÆËÆ§ nginx ÂÆπÂô®Ê≠£Â∏∏Â∑•‰Ωú„ÄÇ

ÁÑ∂ÂêéÊú¨Âú∞‰øÆÊîπ blog ÔºåÂÆåÊàêÂêé‰ΩøÁî®

```bash
# Âõ†‰∏∫ËøôÊòØÊàëËá™Â∑±Áî®ÁöÑÈ°πÁõÆÔºåÊâÄ‰ª•Áõ¥Êé•Áî® -f Êé® master ÂàÜÊîØ„ÄÇÂèçÊ≠£Âú® github ÈÇ£ËæπËøòÊúâ‰∏™Â§á‰ªΩ
# ÔºàËôΩÁÑ∂ github ÈÇ£ËæπÂêåÊ†∑Áî®ÁöÑ -f Êé® master ÔºåÁ¨ëÔºâ
git push -f yuier master
```

ÂëΩ‰ª§Â∞Ü‰øÆÊîπÊé®ÈÄÅÂà∞ÊúçÂä°Âô®‰∏äÁöÑËøúÁ®ã‰ªìÔºåËß¶Âèë git hooks ËÑöÊú¨ÔºåÂπ∂ÂÆûÁé∞Ëá™Âä®ÊûÑÂª∫„ÄÅÈÉ®ÁΩ≤„ÄÇ

ËØªËÄÖÂΩìÂâçÁúãÂà∞ÁöÑÁΩëÁ´ôÂ∞±ÊòØÈÄöËøáËøôÁßçÊñπÂºèÈÉ®ÁΩ≤ÁöÑ„ÄÇ