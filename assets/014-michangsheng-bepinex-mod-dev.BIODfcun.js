import{_ as g}from"./ValaxyMain.vue_vue_type_style_index_0_lang.CF3jKIAV.js";import{d as y,a as F,u as o}from"./chunks/vue-router.0fijYp3S.js";import{a2 as D,a3 as a,a4 as k,a5 as i,a6 as s,a7 as C,B as m,a1 as A,D as B}from"./framework.CL_twgqk.js";import"./app.DJJRq6_7.js";import"./chunks/dayjs.BFInjCTz.js";import"./chunks/vue-i18n.CRimy4L_.js";import"./chunks/pinia.KHo6empO.js";/* empty css                    */import"./chunks/@vueuse/motion.DON3upiQ.js";import"./chunks/nprogress.DUFFUuWH.js";import"./YunComment.vue_vue_type_style_index_0_lang.lpZGJo7w.js";import"./index.C5okkQwF.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang.7-8ddEp8.js";import"./post.D4SLBNdn.js";const u=y("/posts/014-michangsheng-bepinex-mod-dev",async t=>JSON.parse('{"title":"觅长生 BepInEx MOD 开发记录","titleTemplate":"%s - yuier","description":"","frontmatter":{"title":"觅长生 BepInEx MOD 开发记录","titleTemplate":"%s - yuier","date":"2025-11-24 15:41:02","updated":"2025-11-24 15:41:02","author":"yuier","categories":["C#"],"tags":["C#","游戏 MOD","BepInEx","觅长生"],"cover":null,"hide":null},"headers":[],"relativePath":"pages/posts/014-michangsheng-bepinex-mod-dev.md","lastUpdated":1772277401000}'),{lazy:(t,n)=>t.name===n.name}),J={__name:"014-michangsheng-bepinex-mod-dev",setup(t,{expose:n}){const{data:E}=u(),p=o(),r=F(),e=Object.assign(r.meta.frontmatter||{},E.value?.frontmatter||{});return p.currentRoute.value.data=E.value,B("valaxy:frontmatter",e),globalThis.$frontmatter=e,n({frontmatter:{title:"觅长生 BepInEx MOD 开发记录",titleTemplate:"%s - yuier",date:"2025-11-24 15:41:02",updated:"2025-11-24 15:41:02",author:"yuier",categories:["C#"],tags:["C#","游戏 MOD","BepInEx","觅长生"],cover:null,hide:null}}),(h,l)=>{const d=g;return A(),D(d,{frontmatter:m(e)},{"main-content-md":a(()=>[l[0]||(l[0]=i("p",null,[s("感谢宵夜的 B 站专栏 "),i("a",{href:"https://www.bilibili.com/read/readlist/rl355806",target:"_blank",rel:"noreferrer"},"Unity游戏Mod/插件制作教程")],-1)),C(" more "),l[1]||(l[1]=i("h2",{id:"前言",tabindex:"-1"},[s("前言 "),i("a",{class:"header-anchor",href:"#前言","aria-label":'Permalink to "前言"'},"​")],-1)),l[2]||(l[2]=i("p",null,[s("在下载的 BepInEx MOD 本地文件 config 目录下，找到了一个 MOD 开发交流群的 txt 文件，先加一手，宵夜、奶油等大佬都在里边，还有官方开发者也在: "),i("a",{href:"https://qm.qq.com/q/iVZhGzFCx4",target:"_blank",rel:"noreferrer"},"769074914")],-1)),l[3]||(l[3]=i("h2",{id:"问题",tabindex:"-1"},[s("问题 "),i("a",{class:"header-anchor",href:"#问题","aria-label":'Permalink to "问题"'},"​")],-1)),l[4]||(l[4]=i("p",null,"游戏内，玩家在宗门商店内必须使用各个宗门内部货币购买物品，而这个内部货币要到【宗门广场】里找人兑换，于是在【藏经阁】【神兵阁】【炼丹房】内，经常遇到货币不够，出门换货币，再回来换商品；货币还要算着换，以免换多了没用。。。这是个小但很烦人的痛点，之前貌似居然一直没人写相关的优化 MOD ，于是找了一圈无果后的我决定亲自上阵写一个 MOD",-1)),l[5]||(l[5]=i("figure",null,[i("img",{src:"https://s2.loli.net/2025/11/25/VLYUwIMg4O2kcDm.png",alt:"image.png",loading:"lazy",decoding:"async"})],-1)),l[6]||(l[6]=i("h3",{id:"效果",tabindex:"-1"},[s("效果 "),i("a",{class:"header-anchor",href:"#效果","aria-label":'Permalink to "效果"'},"​")],-1)),l[7]||(l[7]=i("p",null,"添加 MOD 后，在宗门商店内，将优先使用宗门货币购买商品；而如果宗门货币不足，将提示使用灵石支付，这样我们就可以在场景内直接完成购买，不必经历一次次繁琐的兑换操作和烦人的黑屏场景切换了。",-1)),l[8]||(l[8]=i("figure",null,[i("img",{src:"https://s2.loli.net/2025/11/25/Nu4irEWa956LoJA.png",alt:"image.png",loading:"lazy",decoding:"async"})],-1)),l[9]||(l[9]=i("p",null,"灵石和内部货币的汇率将会按照官方汇率，一个宗门货币价值 150 灵石，不会影响游戏性。",-1)),l[10]||(l[10]=i("figure",null,[i("img",{src:"https://s2.loli.net/2025/11/25/tKpkZMRsC5OeQfn.png",alt:"image.png",loading:"lazy",decoding:"async"})],-1)),l[11]||(l[11]=i("h2",{id:"bepinex",tabindex:"-1"},[s("BepInEx "),i("a",{class:"header-anchor",href:"#bepinex","aria-label":'Permalink to "BepInEx"'},"​")],-1)),l[12]||(l[12]=i("p",null,"文章开头提到了 BepInEx 框架，其是觅长生当前事实的 MOD 标准框架，本次开发也基于该框架进行。",-1)),l[13]||(l[13]=i("h3",{id:"next",tabindex:"-1"},[s("Next "),i("a",{class:"header-anchor",href:"#next","aria-label":'Permalink to "Next"'},"​")],-1)),l[14]||(l[14]=i("p",null,"Next 框架是奶油佬基于 BepInEx 实现的低/无代码 MOD 开发框架，主要通过配置文件开发，适合在游戏已有功能框架下进行扩展，更适合制作剧情类 MOD 等 ，但对于本次需求的对游戏本身的功能进行改动之类有些不太适合。",-1)),l[15]||(l[15]=i("p",null,"不过在本次项目中依然有用，比如可以使用导出功能方便快捷地查看游戏内数据。",-1)),l[16]||(l[16]=i("p",null,[s("详见 "),i("a",{href:"https://www.bilibili.com/video/BV18a411T7Mh",target:"_blank",rel:"noreferrer"},"【觅长生】Mod制作教程#1.2认识Next框架")],-1)),l[17]||(l[17]=i("h3",{id:"准备",tabindex:"-1"},[s("准备 "),i("a",{class:"header-anchor",href:"#准备","aria-label":'Permalink to "准备"'},"​")],-1)),l[18]||(l[18]=i("p",null,[s("游戏内将 BepInex 做成了一个 MOD，可以直接订阅。订阅后，BepInEx 的文件目录就不在游戏根目录下，而是在 MOD 目录下，即 "),i("code",null,"\\steamapps\\workshop\\content\\1189490\\2824349934"),s(" 目录下")],-1)),l[19]||(l[19]=i("figure",null,[i("img",{src:"https://s2.loli.net/2025/11/24/giGYylKU8ceThDd.png",alt:"image.png",loading:"lazy",decoding:"async"})],-1)),l[20]||(l[20]=i("p",null,"然后入门就是按照文章开头贴的宵夜的教程入门的，不作赘述。",-1)),l[21]||(l[21]=i("h2",{id:"分析与开始",tabindex:"-1"},[s("分析与开始 "),i("a",{class:"header-anchor",href:"#分析与开始","aria-label":'Permalink to "分析与开始"'},"​")],-1)),l[22]||(l[22]=i("p",null,"思路就是找到宗门商店购买物品的事件，将所在函数 patch 了，重写逻辑，实现自己的需求。",-1)),l[23]||(l[23]=i("p",null,"具体怎么找这个事件，奶油在群里很热心地给出了帮助",-1)),l[24]||(l[24]=i("figure",null,[i("img",{src:"https://s2.loli.net/2025/11/25/7ODsBbSrPkYGg1c.png",alt:"QQ_1764074084903.png",loading:"lazy",decoding:"async"})],-1)),l[25]||(l[25]=i("p",null,[s("然而很不幸，我由于对觅长生开发 MOD 一窍不通，在游戏文件、Next 导出数据、反编译代码、乃至 MOD 文件里找了半天，不管是文本字符串，还是文件名，都没找到什么 “看起来有用” 的 exchange ，于是又回去继续问，这次是埋久给了"),i("s",null,"一串神秘字符串"),s("回答 "),i("code",null,"jiaohuanshopgoods")],-1)),l[26]||(l[26]=i("figure",null,[i("img",{src:"https://s2.loli.net/2025/11/25/bTn1L5KrMcs3axu.png",alt:"image.png",loading:"lazy",decoding:"async"})],-1)),l[27]||(l[27]=i("p",null,"分别在 Next 导出数据和反编译代码中搜索，可以找到一个 json 文件和一个类。",-1)),l[28]||(l[28]=i("figure",null,[i("img",{src:"https://s2.loli.net/2025/11/25/oFYRftHwExi4jb5.png",alt:"image.png",loading:"lazy",decoding:"async"})],-1)),l[29]||(l[29]=i("figure",null,[i("img",{src:"https://s2.loli.net/2025/11/25/yeqdYt6CNSlpPRO.png",alt:"image.png",loading:"lazy",decoding:"async"})],-1)),l[30]||(l[30]=i("p",null,[s("再分析这个类的使用，找到一个很可疑的类: "),i("code",null,"UIMenPaiShop")],-1)),l[31]||(l[31]=i("figure",null,[i("img",{src:"https://s2.loli.net/2025/11/25/1dJ8MkwNpK3e2jB.png",alt:"image.png",loading:"lazy",decoding:"async"})],-1)),l[32]||(l[32]=i("p",null,"回群里发一下，又一位热心群友给了最终确认",-1)),l[33]||(l[33]=i("figure",null,[i("img",{src:"https://s2.loli.net/2025/11/25/kJyDipWs9wtVe5b.png",alt:"image.png",loading:"lazy",decoding:"async"})],-1)),l[34]||(l[34]=i("p",null,"OK ，既然找到了入口，那就开干吧。",-1)),l[35]||(l[35]=i("blockquote",null,[i("p",null,"P.S. 多说一句，rider 的反编译比 dnSpy 好用多了，JB ，你就是我的神！")],-1)),l[36]||(l[36]=i("h3",{id:"梳理代码逻辑",tabindex:"-1"},[s("梳理代码逻辑 "),i("a",{class:"header-anchor",href:"#梳理代码逻辑","aria-label":'Permalink to "梳理代码逻辑"'},"​")],-1)),l[37]||(l[37]=i("p",null,"这一步是最简单的一步，因为我直接把代码丢给了通义，代码模式下它给出了极快极准确的注释，给了我极大帮助。如果没有 AI ，光靠我自己看、自己查资料，对于我这样一个 Unity 和 C# 双料门外汉，不知道会有多困难。",-1)),l[38]||(l[38]=i("p",null,[s("这里直接把我润色后的注释完整贴上来，展示 AI 神力 "),i("s",null,"也展示原本的代码是多么屎山")],-1)),l[39]||(l[39]=i("div",{class:"language-cs max-h-900px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"cs"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 在打开宗门商店面板时执行此函数")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 主要内容为拉取数据、循环填充 UI 、绑定事件")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RefreshUI"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 获取当前场景 ID")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    string"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," sceneName"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," SceneEx.NowSceneName;")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 依据场景 ID 拉取游戏内商店数据")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    List"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"NomelShopJsonData"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"all"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," NomelShopJsonData.DataList."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"FindAll"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Predicate"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"NomelShopJsonData"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">) ("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"d"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," =>"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' $"S'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"{"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"d"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"."),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"threeScene"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"}"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," =="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," sceneName));")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (all.Count "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        Debug."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"LogError"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"object"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"UIMenPaiShop刷新UI异常，此场景没有商品信息"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    else")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 依据场景 ID 设置商店面板标题")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".ShopTitle.text "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," all["),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"].Title;")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        int"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," num1"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        int"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," levelType"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," PlayerEx.Player."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getLevelType"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 拉取游戏内物品数据库")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"        ItemDatebase"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," component1"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," jsonData.instance."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"GetComponent"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"ItemDatebase"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">();")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 商店面板分为左中右 3 个区域，使用循环进行处理")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        for"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," index"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"; index "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"<"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 3"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"; "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"++"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"index)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            // 当前区域的数据")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"            NomelShopJsonData"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," nomelShopJsonData"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," all[index];")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            // 获取当前区域的子标题")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"            this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".ShopName[index].text "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," nomelShopJsonData.ChildTitle;")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            // 拉取当前区域下商品数据，即上文提到的 jiaohuanshopgoods")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"            List"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"jiaoHuanShopGoods"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"> "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"shopGoods"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," UIDuiHuanShop."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"GetShopGoods"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(nomelShopJsonData.ExShopID);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            shopGoods."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Sort"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            // 清空 UI")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"            this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".ShopRT[index]."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"DestoryAllChild"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            // 遍历拉取到的当前区域下的商品数据进行处理")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            foreach"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"jiaoHuanShopGoods"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," jiaoHuanShopGoods"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," in"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," shopGoods)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"                jiaoHuanShopGoods"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," good"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," jiaoHuanShopGoods;")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                // 用当前区域内第一个商品需求的货币 ID 作为场景下所有商品需求的货币 ID，这个东西会在函数结尾用到")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                // 这个处理逻辑就问你神不神")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (num1 "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    num1 "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," good.EXGoodsID;")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                // 依据商品 ID 查找物品元数据")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"                _ItemJsonData"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," item"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," _ItemJsonData.DataDict[good.GoodsID];")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                // 这个很长的 if 条件对应了游戏内的设定，宗门藏经阁依据玩家的境界分阶段开放")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (nomelShopJsonData.SType "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ||"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," levelType "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," item.quality "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"||"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," item.type "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 3"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," &&"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," item.type "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"!="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 4"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                    // 生成单个商品 UI 组件")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"                    UIMenPaiShopItem"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," component2"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," UnityEngine.Object."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Instantiate"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"GameObject"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".UIMenPaiShopItemPrefab, ("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Transform"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".ShopRT[index])."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"GetComponent"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"UIMenPaiShopItem"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">();")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                    // 计算商品价格，这也涉及游戏机制")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                    int"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," price"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," item.price "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," good.percent;")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                    // 向上取整")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                    if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (item.price "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"%"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," good.percent "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                        price"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"++"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                    // 组件相关信息填充")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    component2.PriceText.text "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," price."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"ToString"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    component2.PriceIcon.sprite "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," component1.items[good.EXGoodsID].itemIconSprite;")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    component2.IconShow."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"SetItem"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(good.GoodsID);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    component2.IconShow.Count "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                    // 为单个商品 UI 组件绑定事件")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    component2.IconShow.OnClick "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"UnityAction"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"PointerEventData"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">) ("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"p"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," =>")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                        // 计算玩家拥有的货币最多可兑换多少商品，也涉及游戏机制，有些商品只能一个一个地买")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                        int"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," maxNum"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Mathf."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Min"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(PlayerEx.Player."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getItemNum"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(good.EXGoodsID) "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," price, item.maxNum);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                        switch"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (maxNum)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                        {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                            case"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                                // 买不起商品")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                UIPopTip.Inst."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Pop"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(_ItemJsonData.DataDict[good.EXGoodsID].name "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "不足"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                                break"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                            case"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                                // 只能买一个商品，弹出单独购买的 UI")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                USelectBox."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Show"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'$"是否兑换'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"{"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"item"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"."),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"name"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"}"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' x1"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", ("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"UnityAction"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") (() "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=>")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                                    // 又加了一层判断玩家能不能买得起商品的逻辑，属实是自己不信任自己 10 行前的代码了")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                                    if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (PlayerEx.Player."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getItemNum"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(good.EXGoodsID) "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," price)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                    {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                                        // 购买物品的数据处理、提示弹窗等")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                                        // 至此函数圈复杂度爆表")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                        PlayerEx.Player."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"removeItem"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(good.EXGoodsID, price);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                        PlayerEx.Player."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"addItem"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(good.GoodsID, "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", Tools."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"CreateItemSeid"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(good.GoodsID));")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                                        // 这里，买一个东西刷新了整个 UI。如果商店商品有限供应，那么可以理解")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                                        // 但游戏内宗门商店商品无限供应，还来这么一下，实在令人费解")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"                                        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"RefreshUI"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                        UIPopTip.Inst."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Pop"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'$"兑换了'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"{"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"_ItemJsonData"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"."),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"DataDict"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"["),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"good"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"."),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GoodsID"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"]."),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"name"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"}"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'x1"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", PopTipIconType.包裹);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                                    else")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                        UIPopTip.Inst."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Pop"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(_ItemJsonData.DataDict[good.EXGoodsID].name "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "不足"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                }));")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                                break"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                            default"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                                // 可以买多个商品，弹出批量购买的 UI")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                USelectNum."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Show"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"兑换数量 x{num}"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", maxNum, ("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"UnityAction"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">) ("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"num"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," =>")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                                    // 以下逻辑同上")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                                    if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (PlayerEx.Player."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getItemNum"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(good.EXGoodsID) "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," num "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"*"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," price)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                    {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                        PlayerEx.Player."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"removeItem"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(good.EXGoodsID, num "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"*"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," price);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                        PlayerEx.Player."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"addItem"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(good.GoodsID, num, Tools."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"CreateItemSeid"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(good.GoodsID));")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"                                        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"RefreshUI"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                        UIPopTip.Inst."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Pop"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'$"兑换了'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"{"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"_ItemJsonData"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"."),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"DataDict"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"["),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"good"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"."),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GoodsID"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"]."),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"name"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"}"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"x"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"{"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"num"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"}"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", PopTipIconType.包裹);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                                    else")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                        UIPopTip.Inst."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Pop"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(_ItemJsonData.DataDict[good.EXGoodsID].name "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "不足"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                                }));")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                                break"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                        }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    });")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 商店面板右下角会展示玩家持有的宗门货币数量")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".MoneyIcon.sprite "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," component1.items[num1].itemIconSprite;")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".MoneyText.text "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," PlayerEx.Player."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getItemNum"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(num1)."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"ToString"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),l[40]||(l[40]=i("h2",{id:"编码",tabindex:"-1"},[s("编码 "),i("a",{class:"header-anchor",href:"#编码","aria-label":'Permalink to "编码"'},"​")],-1)),l[41]||(l[41]=i("p",null,"我这里参考了一个社区内其他同体量 MOD 的写法，以及一个 B 站视频，这里一并感谢",-1)),l[42]||(l[42]=i("p",null,[s("参考 MOD : "),i("a",{href:"https://steamcommunity.com/sharedfiles/filedetails/?id=3049187211",target:"_blank",rel:"noreferrer"},"商店二楼和客栈加载优化")],-1)),l[43]||(l[43]=i("p",null,[s("B 站视频: "),i("a",{href:"https://www.bilibili.com/video/BV1Tb411f7Ua",target:"_blank",rel:"noreferrer"},"教你使用C#制作觅长生Mod——第一期")],-1)),l[44]||(l[44]=i("h3",{id:"改动内容",tabindex:"-1"},[s("改动内容 "),i("a",{class:"header-anchor",href:"#改动内容","aria-label":'Permalink to "改动内容"'},"​")],-1)),l[45]||(l[45]=i("p",null,"根据上文代码分析，我们需要 patch 的函数主要逻辑是：",-1)),l[46]||(l[46]=i("ul",null,[i("li",null,[i("p",null,"获取当前场景信息")]),i("li",null,[i("p",null,"循环处理交易面板的左中右三块区域"),i("ul",null,[i("li",null,[i("p",null,"拉取当前区域中的商品数据")]),i("li",null,[i("p",null,"为每个商品创建 UI 组件")]),i("li",null,[i("p",null,"为每个商品的 UI 组件绑定点击事件")])])])],-1)),l[47]||(l[47]=i("p",null,"显然，我们只需要修改最后绑定的点击事件的逻辑即可，其余部分依然保持原样。当然，实际上我还是出于代码整洁的考虑在我的 MOD 中对原函数进行了函数拆分等静态优化。",-1)),l[48]||(l[48]=i("p",null,"这是原本绑定的事件",-1)),l[49]||(l[49]=i("div",{class:"language-cs max-h-900px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"cs"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"component2.IconShow.OnClick "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"UnityAction"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"PointerEventData"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">) ("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"p"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," =>")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 计算玩家拥有的货币最多可兑换多少商品，也涉及游戏机制，有些商品只能一个一个地买")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    int"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," maxNum"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," Mathf."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Min"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(PlayerEx.Player."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getItemNum"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(good.EXGoodsID) "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," price, item.maxNum);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    switch"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (maxNum)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        case"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            // 买不起商品，提示玩家持有货币不足")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            UIPopTip.Inst."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Pop"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(_ItemJsonData.DataDict[good.EXGoodsID].name "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "不足"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            break"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        case"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            // 只能买一个商品，弹出单独购买的 UI")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            USelectBox."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Show"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'$"是否兑换'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"{"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"item"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"."),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"name"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"}"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' x1"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", ("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"UnityAction"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},") (() "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=>")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                // 又加了一层判断玩家能不能买得起商品的逻辑，属实是自己不信任自己 5 行前的代码了")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (PlayerEx.Player."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getItemNum"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(good.EXGoodsID) "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," price)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                    // 数据处理、购买成功弹窗提示方面的代码，此处略")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                    .."),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                else")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                    // 提示玩家货币数量不足")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"                    UIPopTip.Inst."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Pop"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(_ItemJsonData.DataDict[good.EXGoodsID].name "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"+"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "不足"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            }));")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            break"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        default"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            // 可以买多个商品，弹出批量购买的 UI")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            USelectNum."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Show"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"兑换数量 x{num}"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", maxNum, ("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"UnityAction"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">) ("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"num"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," =>")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"                // 以下逻辑同上")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"                .."),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"            }));")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"            break"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"});")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),l[50]||(l[50]=i("p",null,[s("当用户买不起一件商品，即 "),i("code",null,"maxNum == 0"),s(" 时，会直接弹出货币不足的告警，然后事件结束。而我准备在此修改，当先判断了门派货币不足时，进入一个 "),i("code",null,"尝试使用灵石购买商品"),s(" 的函数。当玩家灵石充足时，便可以获得物品。")],-1)),l[51]||(l[51]=i("div",{class:"language-cs max-h-900px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"cs"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 修改后的代码 be like:")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"switch"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (maxNum)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    case"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 弹窗提示门派货币不足，询问玩家是否转以灵石购买，并给出以灵石购买时的单价")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        USelectBox."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Show"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'$"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"{"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"_ItemJsonData"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"."),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"DataDict"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"["),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"jiaoHuanShopGoods"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"."),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"EXGoodsID"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"]."),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"name"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"}"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"不足，是否使用灵石兑换"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"{"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"_ItemJsonData"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"."),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"DataDict"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"["),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"goodsMetaData"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"."),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"id"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"]."),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"name"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"}"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'？"'),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," +"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'            $"'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 单价："),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"{"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"goodsPrice"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"."),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"lingshiPrice"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"}"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' 灵石"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", () "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=>"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            // 尝试以灵石购买的函数")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"            MenpaiShopingByLingshi"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(goodsPrice.lingshiPrice, goodsMetaData, __instance);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        });")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        break"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},";")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    case"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"        .."),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    .."),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},".."),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},".."),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},".")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 新增的尝试以灵石购买的函数")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," MenpaiShopingByLingshi"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," lingshiPrice"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"_ItemJsonData"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," goodsMetaData"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"UIMenPaiShop"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," __instance"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"    Avatar"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," player"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," PlayerEx.Player;")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 计算玩家的灵石够买多少商品")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    var"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," maxAffordable"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," GetAffordableGoodsNum"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")player.money, lingshiPrice, goodsMetaData.maxNum);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (maxAffordable "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 如果灵石还是不够买一个，那最终还是弹窗提示")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        UIPopTip.Inst."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Pop"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"灵石不足"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    else"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (maxAffordable "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 由于之前货币不足时已经弹窗供玩家确认过一次，因此这里不再弹窗，直接进行购买的数据操作和成功提示")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // ... 略")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"    else")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"        // 如果灵石够买多个商品，且商品允许批量购买，那还是要弹一个批量购买的窗口的")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        USelectNum."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Show"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"兑换数量 x{num}"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", maxAffordable, ("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"UnityAction"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">) ("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"num"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," =>")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"            // ... 略")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        }));")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),l[52]||(l[52]=i("h2",{id:"插曲",tabindex:"-1"},[s("插曲 "),i("a",{class:"header-anchor",href:"#插曲","aria-label":'Permalink to "插曲"'},"​")],-1)),l[53]||(l[53]=i("h3",{id:"为什么要刷新整个-ui",tabindex:"-1"},[s("为什么要刷新整个 UI ？ "),i("a",{class:"header-anchor",href:"#为什么要刷新整个-ui","aria-label":'Permalink to "为什么要刷新整个 UI ？"'},"​")],-1)),l[54]||(l[54]=i("figure",null,[i("img",{src:"https://s2.loli.net/2025/11/26/wm9B7svnfjUio4J.png",alt:"image.png",loading:"lazy",decoding:"async"})],-1)),l[55]||(l[55]=i("p",null,"上文代码中购买商品的数据操作和弹窗提示被我省略了，实际上原始代码中执行的是这样四行：",-1)),l[56]||(l[56]=i("div",{class:"language-cs max-h-900px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"cs"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 以购买单个物品为例")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 在玩家背包中扣除货币")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"PlayerEx.Player."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"removeItem"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(good.EXGoodsID, price);")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 在玩家背包中增加物品")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"PlayerEx.Player."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"addItem"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(good.GoodsID, "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", Tools."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"CreateItemSeid"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(good.GoodsID));")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 重点来了，调用自己，从头开始刷新整块商店面板")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"this"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"RefreshUI"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 弹窗提示购买成功")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"UIPopTip.Inst."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Pop"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'$"兑换了'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"{"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"_ItemJsonData"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"."),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"DataDict"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"["),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"good"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"."),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"GoodsID"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"]."),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"name"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"}"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'x1"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", PopTipIconType.包裹);")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),l[57]||(l[57]=i("p",null,"其中第三行就很令人费解。也许制作组曾经打算将宗门商店里的商品做成有限购买的，但是实际上目前游戏内，宗门商店就是无限供应的，因此这行纯属多此一举。",-1)),l[58]||(l[58]=i("p",null,"其唯一作用就是，在商店面板的右下角会展示用户持有的宗门货币的数量，这行代码会刷新这个数量，此外不会有更多作用。",-1)),l[59]||(l[59]=i("figure",null,[i("img",{src:"https://s2.loli.net/2025/11/25/qbut7698hcBLPyS.png",alt:"image.png",loading:"lazy",decoding:"async"})],-1)),l[60]||(l[60]=i("p",null,"那么，就让我来结束这一切。",-1)),l[61]||(l[61]=i("figure",null,[i("img",{src:"https://s2.loli.net/2025/11/26/MvobLOQPI5h314f.png",alt:"--.png",loading:"lazy",decoding:"async"})],-1)),l[62]||(l[62]=i("p",null,[s("我将这行代码修改为只刷新右下角货币数量的代码，极大 "),i("s",null,"（其实并不）"),s(" 降低了性能开销，优化了游戏画面表现（大嘘")],-1)),l[63]||(l[63]=i("div",{class:"language-cs max-h-900px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"cs"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"public"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," static"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," void"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," RefreshMenpaiHuobiShow"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"UIMenPaiShop"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," __instance"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 设置货币图标")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    Traverse."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Create"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(__instance)."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Field"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"MoneyIcon"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"GetValue"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Image"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">().sprite "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," jsonData.instance")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"        ."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"GetComponent"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"ItemDatebase"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">().items[MENPAI_HUOBI_ID].itemIconSprite;")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"    // 刷新货币数量")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    Traverse."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Create"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(__instance)."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Field"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"MoneyText"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"GetValue"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Text"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">().text "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," PlayerEx.Player."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getItemNum"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(MENPAI_HUOBI_ID)."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"ToString"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"();")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),l[64]||(l[64]=i("h3",{id:"财富并非身外之物",tabindex:"-1"},[s("财富并非身外之物 "),i("a",{class:"header-anchor",href:"#财富并非身外之物","aria-label":'Permalink to "财富并非身外之物"'},"​")],-1)),l[65]||(l[65]=i("p",null,[s("此处依然涉及被省略的货币与商品的数量操作，但其实在 "),i("code",null,"// 计算玩家的灵石够买多少商品"),s(" 注释对应的代码处即初见端倪。")],-1)),l[66]||(l[66]=i("p",null,[s("对比前文 "),i("code",null,"// 计算玩家拥有的货币最多可兑换多少商品"),s(" 处代码，我们发现，"),i("code",null,"获取玩家灵石数量"),s(" 与 "),i("code",null,"获取玩家宗门货币数量"),s(" 的代码是不一样的")],-1)),l[67]||(l[67]=i("div",{class:"language-cs max-h-900px"},[i("button",{title:"Copy code",class:"copy"}),i("span",{class:"lang"},"cs"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 获取玩家宗门货币数量")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"PlayerEx.Player."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"getItemNum"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(good.EXGoodsID)")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"// 获取玩家灵石数量")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"int"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")player.money")])])]),i("button",{class:"code-block-unfold-btn"})],-1)),l[68]||(l[68]=i("p",null,[s("没错，在游戏代码中，"),i("code",null,"宗门货币"),s(" 是玩家背包中的 "),i("code",null,"物品"),s(" ，而 "),i("code",null,"灵石"),s(" 是玩家自身存在的名为 "),i("code",null,"money"),s(" 的 "),i("code",null,"属性"),s(" ！")],-1)),l[69]||(l[69]=i("p",null,"灵石并非身外之物，修仙四要，法财侣地，诚不我欺（",-1)),l[70]||(l[70]=i("p",null,"当时写第一版代码时不知道这回事，试图在背包里查灵石数量，结果账户里一个亿的灵石查出来数量是 0 ，搞得我摸不着头脑；又去找了普通商店的代码看，才明白是怎么回事。",-1)),l[71]||(l[71]=i("h2",{id:"上传",tabindex:"-1"},[s("上传 "),i("a",{class:"header-anchor",href:"#上传","aria-label":'Permalink to "上传"'},"​")],-1)),l[72]||(l[72]=i("p",null,"游戏内做了创意工坊工具，管理 MOD 很方便。",-1)),l[73]||(l[73]=i("p",null,"游戏标题页左下角有个创意工坊",-1)),l[74]||(l[74]=i("figure",null,[i("img",{src:"https://s2.loli.net/2025/11/26/o4n3qOirXxEVUpa.png",alt:"image.png",loading:"lazy",decoding:"async"})],-1)),l[75]||(l[75]=i("p",null,"点开后，上方第三个 TAB 页就是上传模组的页面；右下角的上传说明，写得很详细",-1)),l[76]||(l[76]=i("figure",null,[i("img",{src:"https://s2.loli.net/2025/11/26/L9en1zjSwCkF6Ny.png",alt:"image.png",loading:"lazy",decoding:"async"})],-1)),l[77]||(l[77]=i("hr",null,null,-1)),l[78]||(l[78]=i("p",null,"最后，贴一下 MOD 地址",-1)),l[79]||(l[79]=i("p",null,[i("a",{href:"https://steamcommunity.com/sharedfiles/filedetails/?id=3612097088",target:"_blank",rel:"noreferrer"},"在宗门商店内可直接使用灵石")],-1)),l[80]||(l[80]=i("p",null,"仓库地址",-1)),l[81]||(l[81]=i("p",null,[i("a",{href:"https://github.com/liyuier/UseLingshiInsideZongmen",target:"_blank",rel:"noreferrer"},"https://github.com/liyuier/UseLingshiInsideZongmen")],-1))]),"main-header":a(()=>[k(h.$slots,"main-header")]),"main-header-after":a(()=>[k(h.$slots,"main-header-after")]),"main-nav":a(()=>[k(h.$slots,"main-nav")]),"main-content-before":a(()=>[k(h.$slots,"main-content-before")]),"main-content":a(()=>[k(h.$slots,"main-content")]),"main-content-after":a(()=>[k(h.$slots,"main-content-after")]),"main-nav-before":a(()=>[k(h.$slots,"main-nav-before")]),"main-nav-after":a(()=>[k(h.$slots,"main-nav-after")]),comment:a(()=>[k(h.$slots,"comment")]),footer:a(()=>[k(h.$slots,"footer")]),aside:a(()=>[k(h.$slots,"aside")]),"aside-custom":a(()=>[k(h.$slots,"aside-custom")]),default:a(()=>[k(h.$slots,"default")]),_:3},8,["frontmatter"])}}};export{J as default,u as usePageData};
